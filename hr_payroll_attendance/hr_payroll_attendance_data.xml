<?xml version="1.0"?>
<openerp>
  <data noupdate="1">

    <!-- Automatic action -->
    <record model="ir.actions.server" id="action_notify_attendance_change">
      <field name="name">Notify Attendance Change</field>
      <field name="state">code</field>
      <field name="condition" eval="True" />
      <field name="model_id" ref="hr_attendance.model_hr_attendance" />
      <field name="code">
env['bus.bus'].sendone('attendance',object.id)
      </field>
    </record>

    <record model="base.action.rule" id="notify_attendance_change">
      <field name="name">Notify Attendance Change</field>
      <field name="kind">on_create</field>
      <field name="sequence">2</field>
      <field name="model_id" ref="hr_attendance.model_hr_attendance" />
      <field name="server_action_ids"   eval="[(6,0, [ref('action_notify_attendance_change')])]"/>
    </record>

    <record model="ir.cron" id="auto_log_out">
      <field name="name">Automatically Log Out All Employees In Midnight</field>
      <field name="user_id" ref="base.user_root"/>
      <field name="nextcall" eval="time.strftime('%s-%0d-%0d 00:00:00' %(DateTime.today().year, DateTime.today().month, DateTime.today().day + 1))"/>
      <field name="model">hr.attendance</field>
      <field name="function">auto_log_out</field>
      <field name="interval_number">1</field>
      <field name="interval_type">days</field>
      <field name="numbercall">-1</field>
      <field name="doall" eval="True"/>
      <field name="active" eval="True"/>
    </record>

    <record model="ir.cron" id="absent_notification">
      <field name="name">Send message to absent employees</field>
      <field name="user_id" ref="base.user_root"/>
      <field name="nextcall" eval="time.strftime('%s-%0d-%0d 09:00:00' %(DateTime.today().year, DateTime.today().month, DateTime.today().day + 1))"/>
      <field name="model">hr.attendance</field>
      <field name="function">absent_notification</field>
      <field name="interval_number">1</field>
      <field name="interval_type">days</field>
      <field name="numbercall">-1</field>
      <field name="doall" eval="True"/>
      <field name="active" eval="True"/>
    </record>

    <record model="ir.cron" id="sick_notification">
      <field name="name">Send message to employees has been sick over 7 days</field>
      <field name="user_id" ref="base.user_root"/>
      <field name="nextcall" eval="time.strftime('%s-%0d-%0d 09:00:00' %(DateTime.today().year, DateTime.today().month, DateTime.today().day + 1))"/>
      <field name="model">hr.attendance</field>
      <field name="function">sick_notification</field>
      <field name="interval_number">1</field>
      <field name="interval_type">days</field>
      <field name="numbercall">-1</field>
      <field name="doall" eval="True"/>
      <field name="active" eval="True"/>
    </record>

  </data>
</openerp>
